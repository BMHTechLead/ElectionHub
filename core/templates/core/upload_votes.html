{% extends "core/base.html" %}
{% load humanize %}
{% block title %}Upload Voting | ElectionHub{% endblock %}

{% block content %}

<div class="mb-4">
  <h3 class="fw-bold mb-1">Upload Voting File</h3>
  <div class="text-muted small">
    Election: {{ election.name }} â€¢ Governorate: {{ governorate.name }}
  </div>
</div>

<div class="card shadow-sm border-0">
  <div class="card-body">

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <div class="mb-3">
        <input type="file"
               name="file"
               class="form-control"
               accept=".xlsx,.xls"
               required>
      </div>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-outline-success">
          Upload
        </button>

        <a href="{% url 'governorate_detail' election.id governorate.id %}"
           class="btn btn-outline-secondary">
          Back
        </a>
      </div>

    </form>

    <div class="mt-4 small text-muted">
      <strong>Required headers:</strong><br>
      Governorate, Candidate number, Candidate name,
      List Name, List Number, Gender,
      Voting type, Voting Governorate,
      Election Unit Number, Election Unit Name,
      Election Unit Address, Station Number,
      Number of Votes
    </div>

  </div>
</div>

<!-- ================= UPLOAD REPORT ================= -->

{% if report %}
<hr class="my-4">

<h5 class="fw-bold text-success mb-3">Upload Report</h5>

<div class="row g-3 mb-4">

  <div class="col-md-4">
    <div class="card border-success shadow-sm text-center">
      <div class="card-body">
        <div class="text-muted small">Inserted</div>
        <div class="fs-4 fw-bold text-success">
          {{ inserted|default:0|intcomma }}
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card border-warning shadow-sm text-center">
      <div class="card-body">
        <div class="text-muted small">Updated</div>
        <div class="fs-4 fw-bold text-warning">
          {{ updated|default:0|intcomma }}
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card border-danger shadow-sm text-center">
      <div class="card-body">
        <div class="text-muted small">Skipped</div>
        <div class="fs-4 fw-bold text-danger">
          {{ skipped|default:0|intcomma }}
        </div>
      </div>
    </div>
  </div>

</div>

{% if errors %}
<div class="card border-danger shadow-sm">
  <div class="card-body">
    <h6 class="fw-bold text-danger">Error Preview</h6>
    <ul class="small text-danger mb-0">
      {% for e in errors %}
        <li>{{ e }}</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endif %}

{% endif %}

{% endblock %}
